/*! front-end 2021-08-17 */

!function(){console.log("welcome 2 tha world"),document.querySelector(".admin-btn").addEventListener("click",()=>{document.querySelector(".admin-nav").style.display="block"},!1),document.querySelector(".reg-btn").addEventListener("click",()=>{document.querySelector(".form-register").style.display="block",document.querySelector(".form-login").style.display="none"},!1),document.querySelector(".login-btn").addEventListener("click",()=>{document.querySelector(".form-login").style.display="block",document.querySelector(".form-register").style.display="none"},!1);let a;$.ajax({url:"js/config.json",type:"GET",dataType:"json",success:function(e){console.log(e),a=`${e.SERVER_URL}:${e.SERVER_PORT}`,console.log(a)},error:function(e){console.log("error:",e)}}),$.ajax({url:`${a}/allProductsFromDB`,type:"GET",dataType:"json",success:function(e){console.log(e);for(var o=0;o<e.length;o++);},error:function(){}}),$("#addProduct").click(function(){event.preventDefault();var e=$("#a-name").val(),o=$("#a-price").val(),r=$("#a-imageurl").val(),t=sessionStorage.getItem("userID");console.log(e,o,r,t),""==e||""==o||""==t?alert("pls enter all details :/"):$.ajax({url:`${a}/addProduct`,type:"POST",data:{name:e,price:o,image_url:r,user_id:t},success:function(e){console.log(e),alert("product added,,!")},error:function(){console.log("error: cant call api")}})}),$("#updateProduct").click(function(){event.preventDefault();var e=$("#productId").val(),o=$("#productName").val(),r=$("#productPrice").val(),t=$("#imageurl").val(),l=sessionStorage.getItem("userID");console.log(e,o,r,t,l),""==e?alert("pls enter the id of the product ur updating"):$.ajax({url:`${a}/update/${e}`,type:"PATCH",data:{name:o,price:r,image_url:t,user_id:l},success:function(e){console.log(e),"401 error: user has no permission to update"==e?alert("401 error: user has no permission to update"):alert("updated successfully :3"),$("#productId").val(""),$("#productName").val(""),$("#productPrice").val(""),$("#productImg").val("")},error:function(){console.log("error: cant call api")}})}),$("#deleteProduct").click(function(){var e;event.preventDefault(),sessionStorage.userID?(e=$("#delProductId").val(),console.log(e),""==e?alert("please enter an id to delete product"):$.ajax({url:`${a}/delete/${e}`,type:"DELETE",data:{user_id:sessionStorage.userID},success:function(e){console.log(e),"deleted"==e?(alert("successfully deleted"),$("#delProductId").val("")):alert("enter a valid id")},error:function(){console.log("err cant call api")}})):alert("u dont have the right to do this, log in first. 401 permission denied")}),$("#regBtn").click(function(){event.preventDefault();var e=$("#regUser").val(),o=$("#regEmail").val(),r=$("#regPass").val();console.log(e,o,r),""===e||""===o||""===r?alert("enter all your details fool"):$.ajax({url:`${a}/registerUser`,type:"POST",data:{username:e,email:o,password:r},success:function(e){console.log(e),"username already taken. pls use a different username."==!e?alert("Please log in to manipulate the product data"):(alert("username taken already, pls try another name"),$("#regUser").val(""),$("#regEmail").val(""),$("#regPass").val(""))},error:function(){console.log("error: cant call api :")}})}),$("#loginBtn").click(function(){event.preventDefault();var e=$("#loginUser").val(),o=$("#loginPass").val();console.log(e,o),""===e||""===o?alert("enter all your details fool"):$.ajax({url:`${a}/loginUser`,type:"POST",data:{username:e,password:o},success:function(e){console.log(e),"user not found. please register :)"==e?alert("user not found, pls register as a new user or enter correct data"):"not authorized"==e?(alert("get out of here,,, please try with correct details"),$("#loginUser").val(""),$("#loginPass").val("")):(sessionStorage.setItem("userID",e._id),sessionStorage.setItem("userName",e.username),sessionStorage.setItem("userEmail",e.email),sessionStorage.setItem("passWord",e.password),console.log(sessionStorage))}})}),$("#logoutBtn").click(function(){sessionStorage.clear(),console.log("yourve been logged out."),console.log(sessionStorage)}),$("h1").click(function(){console.log(sessionStorage)})}();